<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>MySelfieBooth ‚Äì Priorit√©s</title>
  <link rel="stylesheet" href="/static/style.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body>
  <header class="container">
    <h1>MySelfieBooth ‚Äì Tableau des t√¢ches & Next Action</h1>
  </header>

<main class="container">

  <section class="card">
    <h2>üéØ Priorit√© imm√©diate</h2>
    <div class="next-action">
      <div class="na-title">{{ top.action | default("‚Äî") }}</div>
      <div class="na-reason">{{ top.raison | default("En attente de recommandation‚Ä¶") }}</div>
      <div class="na-meta">
        <strong>Impact :</strong> {{ top.impact | default("‚Äî") }}
        &nbsp;‚Ä¢&nbsp;
        <strong>Cat√©gorie :</strong> {{ top.categorie | default("‚Äî") }}
      </div>
    </div>
  </section>

  <section class="card">
    <h2>üîù Plan d‚Äôaction propos√© par l‚ÄôIA</h2>
    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>Action</th>
            <th>Raison</th>
            <th>Impact</th>
            <th>Cat√©gorie</th>
          </tr>
        </thead>
        <tbody>
          {% for t in actions %}
          <tr>
            <td>{{ t.action | default("‚Äî") }}</td>
            <td>{{ t.raison | default("‚Äî") }}</td>
            <td>{{ t.impact | default("‚Äî") }}</td>
            <td>{{ t.categorie | default("‚Äî") }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </section>


  <section class="card">
    <h2>üìä Objectifs strat√©giques (Excel)</h2>
    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>Domaine</th>
            <th>Objectif</th>
            <th>Priorit√©</th>
          </tr>
        </thead>
        <tbody>
        {% for obj in objectives %}
          <tr>
            <td>{{ obj.domaine }}</td>
            <td>
              <div class="objective-title">{{ obj.objectif }}</div>
              {% if obj.resume %}
              <div class="objective-sub">{{ obj.resume }}</div>
              {% endif %}
            </td>
            <td>
              <span class="tag {{ obj.priorite|lower|replace(' ', '-') }}">
                {{ obj.priorite }}
              </span>
            </td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
  </section>


    <section class="card">
      <h2>üìã T√¢ches (Notion)</h2>
      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th>T√¢che</th>
              <th>Priorit√©</th>
              <th>√âch√©ance</th>
              <th>Urgence</th>
            </tr>
          </thead>
          <tbody>
          {% for t in tasks %}
            <tr>
              <td>{{ t.title }}</td>
              <td>
                <span class="tag {{ t.prio|lower|replace(' ', '-') }}">
                  {{ t.prio }}
                </span>
              </td>
              <td>
                {% if t.due_date %}
                  {{ t.due_date.split('T')[0] }}
                {% else %}
                  ‚Äî
                {% endif %}
              </td>
              <td>
                {% if t.days_remaining is not none %}
                  {% if t.days_remaining < 0 %}
                    <span class="urgency overdue">En retard de {{ t.days_remaining | abs }} j</span>
                  {% elif t.days_remaining == 0 %}
                    <span class="urgency due-today">√âch√©ance aujourd'hui</span>
                  {% elif t.days_remaining <= 3 %}
                    <span class="urgency due-soon">{{ t.days_remaining }} j restants</span>
                  {% else %}
                    <span class="urgency">{{ t.days_remaining }} j</span>
                  {% endif %}
                {% else %}
                  ‚Äî
                {% endif %}
              </td>
            </tr>
          {% endfor %}
          </tbody>
        </table>
      </div>
    </section>
  </main>

  <footer class="container footnote">
    G√©n√©r√© par FastAPI ‚Ä¢ Notion ‚Ä¢ OpenAI
  </footer>
</body>
</html>
